
#Etude données 2020

##Récupération des données

```{r chargementData1, echo=TRUE}
# Trying ISO-8859-1
raw_data <- read.csv("data/data_2020.csv", sep = ";")
```

Définir toutes les données comme caractère (variable qualitative) sauf le salaire

```{r colonnesQualitative1}
# Lists specifying which columns to convert to factors and numeric
factor_cols <- c("Date", "identifiant", "Genre", "Annee_diplome","Type_formation","Filiere","Situation","Secteur","Nature_contrat", "France","Region", "Pays", "Taille_entreprise", "Nom_entreprise", "Departement", "Intitule_poste", "Secteur_activite")
numeric_cols <- c("Anciennete", "Salaire_annuel", "Responsabilite_hierarchique", "Responsabilite_budget", "Responsabilite_equipe", "Responsabilite_projet", "Satisfaction_globale", "Saitisfaction_relations", "Satisfaction_salaire", "Satisfaction_autonomie", "Satisfaction_localisation")

# Convert columns to factors
raw_data[factor_cols] <- lapply(raw_data[factor_cols], as.factor)

# Convert columns to numeric
raw_data[numeric_cols] <- lapply(raw_data[numeric_cols], as.numeric)
```

```{r affichageSummaryRawData1, echo=FALSE, eval=FALSE}
summary(raw_data)
```

Avec ces valeurs on peut déduire beaucoup de choses...

##Fonction de filtre

Ceci est une fonction utilisé après pour retirer différentes lignes en fonction des valeurs dans une certain colonne. (équivalent d'un select where)

```{r fonctionFiltre1}
remove_rows_by_value <- function(data, column_name, value_to_remove) {
  data_filtered <- subset(data, !(data[[column_name]] == value_to_remove))
  return(data_filtered)
}
```

##Première étude

###Disparité homme/femme - toute formation confondue

```{r etude1}
boxplot(raw_data$Salaire_annuel ~ raw_data$Genre)
```

En 2020, on constate que les hommes, peu importe leur filière, ont un bien meilleur salaire que les femmes diplomées de Polytech.

###Disparité sur les dates d'optention du diplôme

```{r etude2}
boxplot(raw_data$Salaire_annuel ~ raw_data$Annee_diplome)
```

On peut voir que les salaire des diplomés en 2017 et 2018 sont assez équivalents. En 2019 cependant, il y a une baisse par rapport aux années précédentes. Cela peut s'expliquer par le fait que les débutants ont un salaire plus bas que les salariés de longue date.

###Disparité formation initiale/apprentissage/contrat de professionalisation

```{r etude3}
boxplot(raw_data$Salaire_annuel ~ raw_data$Type_formation)
```

En moyenne, les apprentis et les élèves en professionnalisation semble avoir de meilleurs salaires que les étudiants en formation initiale. Par contre, il y a beaucoup de disparités parmi les salaires de ces derniers.

###Disparité des filières

```{r etude4}
boxplot(raw_data$Salaire_annuel ~ raw_data$Filiere)
```

La filière ayant les meilleurs salaires est la filière MSI. Puis viennent les SE, puis les IG et les MI. La filière la moins bien rémunérée en 2020 est STE.

###Filtrage des personnes en activité

```{r filtrage_activite1}
filtered_data <- remove_rows_by_value(raw_data, "Situation", "En recherche emploi")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En poursuite d'études (hors thèse) / en formation")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "These")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Sans activité") 
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Volontariat")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En création d'entreprise /reprise d'entreprise")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Etudes")

activite_data <- filtered_data
```

###Disparité par nature du contrat

```{r etude7, warning=FALSE}
# Filtrage de certains contrat peu représentatif
filtered_data <- remove_rows_by_value(activite_data, "Nature_contrat", "Service à la personne (cours particulier de mathématiques via Acadomia)")
filtered_data <- remove_rows_by_value(filtered_data, "Nature_contrat", "")

ggplot(filtered_data, aes(x = Nature_contrat, y = Salaire_annuel)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Salary Distribution by Contract Type", x = "Contract Type", y = "Salary")
```


On peut noter que les personnes en CDI ont un avantage conséquent par rapport aux CDD. Les quelques contrats locaux ont cependant un salaire encore meilleur.

###Distribution du salaire en fonction de l'ancienneté

```{r etude8}

ordered_data <- raw_data[order(as.numeric(raw_data$Anciennete)), ]

boxplot(raw_data$Salaire_annuel ~ as.numeric(raw_data$Anciennete), data = ordered_data)
```

Il ne semble pas avoir de corrélation entre l'ancienneté et le salaire. Il ne semble pas y avoir de tendance a augmenter ou à baisser suivant l'ancienneté.

###Distribution du salaire en fonction de l'ancienneté (Groupée)

```{r etude9}
monthGroup <- cut(as.numeric(raw_data$Anciennete),
                               breaks = c(0, 6, 12, 24, Inf),
                               labels = c("1-6", "7-12", "13-24", "25+"),
                               right = FALSE)


boxplot(raw_data$Salaire_annuel ~ monthGroup, data = raw_data)
```

En regroupant l'ancienneté sur des périodes de 6 mois, on remarque une augmentation progressive à partir de 7 mois, mais elle n'est pas conséquente.

###Distribution du salaire en fonction de France/étranger

```{r etude10}
boxplot(raw_data$Salaire_annuel ~ raw_data$France)
```

Les étudiants partis travailler à l'étranger semblent avoir de meilleurs salaires mais il y a une grande disparité pour les salaires étrangers.

###Distribution du salaire en fonction du pays à l'étranger

```{r etude11, warning=FALSE}
raw_data_filtered <- raw_data[complete.cases(raw_data$Pays) & raw_data$Pays != "" & !grepl("^\\s*$", raw_data$Pays) & !is.na(raw_data$Salaire_annuel), ]


median_salaries <- tapply(raw_data_filtered$Salaire_annuel, raw_data_filtered$Pays, median)
median_order <- names(sort(median_salaries))

emploiFactor <- factor(raw_data_filtered$Pays, levels = median_order)



ggplot(raw_data_filtered, aes(x = emploiFactor, y = Salaire_annuel)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Salary Distribution by Country", x = "Country", y = "Salary")
```

Il n'y a pas assez de données pour faire des études plus importantes, on constate que c'est en Suisse que les diplomés de Polytech ont les meilleurs salaires contrairement à la Thaïlande.
