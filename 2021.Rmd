# Etude données 2021

## Récupération des données

```{r chargementData}
# Trying ISO-8859-1
raw_data <- read.csv("data/data_2021.csv", sep = ",", fileEncoding = "UTF-8")
```


Définir toutes les données comme caractère (variable qualitative) sauf le salaire

```{r colonnesQualitative}
# Lists specifying which columns to convert to factors and numeric
factor_cols <- c("Date", "Identifiant", "Genre", "Annee_diplome","Type_formation","Filiere","Situation","Secteur","Nature_contrat", "France","Region", "Pays", "Taille_entreprise", "Nom_entreprise", "Departement", "Intitule_poste", "Secteur_activite")
numeric_cols <- c("Anciennete", "Salaire_annuel", "Responsabilite_budget", "Responsabilite_equipe", "Responsabilite_projet", "Satisfaction_globale", "Satisfaction_salaire", "Satisfaction_autonomie", "Satisfaction_localisation")

# Convert columns to factors
raw_data[factor_cols] <- lapply(raw_data[factor_cols], as.factor)

# Convert columns to numeric
raw_data[numeric_cols] <- lapply(raw_data[numeric_cols], as.numeric)
```

```{r affichageSummaryRawData, eval=FALSE}
summary(raw_data)
```

Avec ces valeurs on peut déduire beaucoup de choses... 

### Fonction de filtre 
Ceci est une fonction utilisé après pour retirer différentes lignes en fonction des valeurs dans une certain colonne. (équivalent d'un select where)
```{r fonctionFiltre}
remove_rows_by_value <- function(data, column_name, value_to_remove) {
  data_filtered <- subset(data, !(data[[column_name]] == value_to_remove))
  return(data_filtered)
}
```

## Première étude 

### Disparité homme/femme - toute formation confondue
```{r etude1}
ggplot(raw_data, aes(x = Genre, y = Salaire_annuel, fill = Genre)) +
  geom_boxplot(width = 0.5, notch = TRUE, outlier.shape = NA) +
  labs(title = "Différences de salaire par genre",
       x = "Genre",
       y = "Salaire Annuel") +
  theme_minimal() +
  theme(legend.position = "none")
```

En observant les boîtes à moustaches fournies pour les différentes années, une caractéristique notable est l'étendue plus grande de la partie supérieure des boîtes, particulièrement pour les hommes. Cette étendue supérieure, aussi connue sous le nom de troisième quartile, montre le salaire au-dessus duquel se situent les 25 % des salariés les mieux payés.

Pour les hommes, il est visible que la distribution des salaires s'étale sur une plage plus large au-dessus de la médiane, ce qui indique que non seulement il y a des hommes qui gagnent plus que la médiane, mais aussi que parmi eux, il existe une variété considérable de salaires élevés. En comparaison, pour les femmes, bien que la distribution au-dessus de la médiane soit présente, elle est moins étendue, suggérant que les salaires élevés sont moins fréquents ou moins dispersés.

Cette observation peut signaler que, dans la population étudiée, il y a une plus grande hétérogénéité dans les niveaux de rémunération des hommes au-dessus de la médiane salariale. Cela pourrait indiquer une présence accrue d'hommes dans des rôles de haute rémunération ou des positions de leadership, ou encore refléter des différences dans les opportunités de carrière ou les négociations salariales qui favorisent les hommes.

Il est également possible que des facteurs tels que l'ancienneté, le secteur d'activité ou la spécialisation professionnelle influencent cette distribution. Les femmes peuvent être sous-représentées dans des postes ou des industries à haute rémunération, ou des barrières systémiques pourraient limiter leur progression salariale au-delà d'un certain seuil. Ces graphiques suggèrent l'importance d'une analyse plus approfondie pour comprendre et aborder les dynamiques qui conduisent à ces disparités de salaire entre les genres.


### Disparité sur les dates d'optention du diplôme

```{r etude2}
ggplot(raw_data, aes(x = Salaire_annuel, fill = as.factor(Annee_diplome))) +
  geom_density(alpha = 0.5) +
  labs(title = "Distribution des salaires par année de diplôme",
       x = "Salaire Annuel",
       fill = "Année de Diplôme") +
  theme_minimal()
```

Le premier diagramme, qui présente les données des années de diplôme 2018 à 2020, montre une tendance à la diversification des salaires annuels, particulièrement pour l'année 2020 où la distribution est visiblement plus étendue. Ceci contraste avec les distributions plus concentrées des années 2017 à 2019 et 2016 à 2018, observées dans les autres diagrammes, où les courbes de densité sont plus pointues et moins dispersées.

La courbe élargie pour les diplômés de 2020 suggère une variabilité accrue dans les salaires de départ, ce qui pourrait indiquer une diversification des rôles disponibles pour les nouveaux diplômés ou refléter l'impact de facteurs économiques tels que les fluctuations du marché du travail.

La cohorte de 2018, qui apparaît dans tous les graphiques, offre une référence de comparaison intéressante. La stabilité relative de sa distribution suggère que les conditions du marché pour cette cohorte n'ont pas changé de manière significative au fil du temps, du moins en termes de salaires de départ.

Cette analyse globale indique que bien que les conditions du marché pour les diplômés de 2018 soient restées constantes, les diplômés de 2020 sont entrés sur un marché du travail potentiellement différent, avec une gamme de salaires initiaux plus large, pointant vers une évolution des conditions économiques ou des politiques d'embauche qui pourraient avoir influencé la structure salariale des nouveaux entrants.


### Disparité formation initiale/apprentissage/contrat de professionalisation
```{r etude3}
library(ggplot2)

# Supprimer les lignes où 'Type_formation' est NA ou vide
clean_data <- raw_data[!is.na(raw_data$Type_formation) & raw_data$Type_formation != "", ]

# Créer le graphique avec les données nettoyées
ggplot(clean_data, aes(x = as.factor(Type_formation), y = Salaire_annuel, fill = as.factor(Type_formation))) +
  stat_summary(fun = "mean", geom = "col") +
  labs(title = "Moyenne des salaires par type de formation",
       x = "Type de Formation",
       y = "Moyenne du Salaire Annuel",
       fill = "Type de Formation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

En examinant le premier diagramme et en le comparant aux deux autres, nous constatons une inversion dans la hiérarchie des salaires moyens par type de formation. Dans le premier diagramme, le type de formation par apprentissage montre le salaire moyen le plus élevé, suivi de la professionnalisation et enfin de la formation initiale, qui présente le salaire moyen le plus bas.

Cette tendance est à l'opposé de ce qui est observé dans les deux autres diagrammes, où la professionnalisation mène généralement avec le salaire moyen le plus élevé, et l'apprentissage est le plus bas. Cette inversion pourrait être le résultat de plusieurs facteurs, comme des changements dans la perception de la valeur de l'apprentissage sur le marché du travail, des modifications dans les structures de rémunération, ou des évolutions dans les opportunités de carrière post-apprentissage.

Il est également possible que cette différence soit due à des variations annuelles spécifiques, des changements dans les secteurs économiques qui embauchent des apprentis, ou des politiques incitatives qui valorisent l'apprentissage. Pour comprendre pleinement ces tendances, une analyse plus détaillée qui inclut d'autres variables et contextes de marché serait nécessaire.


### Disparité des filières

```{r etude4}
ggplot(raw_data, aes(x = Filiere, y = Salaire_annuel, fill = Filiere)) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8) +
  geom_boxplot(width = 0.2, fill = "white", color = "black", outlier.shape = NA) +
  labs(title = "Distribution des salaires par filière",
       x = "Filière",
       y = "Salaire Annuel",
       fill = "Filière") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


### Filtrage des personnes en activité 
```{r filtrage_activite}
filtered_data <- remove_rows_by_value(raw_data, "Situation", "En recherche emploi")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En poursuite d'études (hors thèse) / en formation")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "These")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Sans activité") 
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Volontariat")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En création d'entreprise /reprise d'entreprise")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Etudes")

activite_data <- filtered_data
```



### Disparité par nature du contrat
```{r etude7, warning=FALSE}
library(ggplot2)

# Remplacer 'activite_data' par votre dataframe réel
# Filtrage de certains contrats peu représentatifs
filtered_data <- raw_data[!raw_data$Nature_contrat %in% c("Service à la personne (cours particulier de mathématiques via Acadomia)", ""), ]

# Supposons que les catégories de contrats sont 'CDD', 'CDI', 'Intérim', etc.
# Vous pouvez définir manuellement les couleurs pour chaque catégorie de contrat
couleurs_contrats <- c("CDD" = "#66c2a5", "CDI" = "#fc8d62", "Intérim" = "#8da0cb", 
                       "Stage" = "#e78ac3", "Alternance" = "#a6d854", "CTT" = "#e78ac3")

# Diagramme en boîte avec couleurs
ggplot(filtered_data, aes(x = Nature_contrat, y = Salaire_annuel, fill = Nature_contrat)) +
  geom_boxplot() +
  scale_fill_manual(values = couleurs_contrats) +  # Utiliser les couleurs définies précédemment
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Distribution des salaires par type de contrat", x = "Type de Contrat", y = "Salaire Annuel")

```

Sur le diagramme "Distribution des salaires par type de contrat", nous observons les salaires annuels associés à différents types de contrats de travail. La médiane des salaires, illustrée par la ligne au centre de chaque boîte, permet de comparer les niveaux de rémunération médians entre les types de contrats.

Les contrats à durée déterminée (CDD) présentent une médiane inférieure et une distribution relativement concentrée, indiquant une uniformité dans les salaires mais également des niveaux de rémunération généralement plus bas. Ceci est attendu étant donné la nature temporaire et souvent précaire des CDD.

Les contrats à durée indéterminée (CDI) affichent une médiane plus élevée, soulignant le salaire plus stable et souvent plus avantageux associé à la sécurité de l'emploi à long terme. La variabilité des salaires est également plus large, reflétant une diversité de postes et de niveaux de responsabilité.

Les CDI à l'étranger semblent offrir des salaires encore plus élevés, ce qui pourrait être attribué aux primes d'expatriation ou aux différences de marchés du travail entre pays.

Les contrats d'expatriation montrent une distribution similaire aux CDI étrangers, avec des salaires médians élevés, ce qui est cohérent avec les avantages financiers souvent associés à l'expatriation.

Les contrats locaux, possiblement des contrats standards dans le pays d'emploi, présentent une médiane plus basse, suggérant des salaires moins compétitifs ou des rôles moins spécialisés.

Les contrats de travail temporaire (CTT) et les postes intérimaires indiquent des médianes plus faibles et des distributions étroites, alignées sur la nature éphémère et les rémunérations moins élevées de ces emplois.

Les postes permanents équivalents à un CDI révèlent une médiane et une distribution comparables aux CDI, ce qui suggère des conditions d'emploi et de rémunération similaires.

Les titulaires de la fonction publique présentent une distribution des salaires plus resserrée, ce qui peut refléter une grille salariale plus standardisée dans le secteur public.

En résumé, le graphique met en exergue le fait que les CDI, tant nationaux qu'internationaux, ainsi que les postes permanents et les fonctionnaires, tendent à offrir des salaires médians supérieurs par rapport aux contrats temporaires et locaux, illustrant l'influence significative de la stabilité de l'emploi et de la localisation géographique sur les niveaux de salaire.


### Distribution du salaire en fonction de l'ancienneté 

```{r etude8}

library(ggplot2)

# Création de catégories d'ancienneté (facultatif)
ordered_data$Anciennete_category <- cut(as.numeric(ordered_data$Anciennete), breaks = 5)

# Diagramme en barres pour la moyenne des salaires en fonction de l'ancienneté
ggplot(ordered_data, aes(x = Anciennete_category, y = Salaire_annuel, fill = Anciennete_category)) +
  geom_bar(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Moyenne des salaires en fonction de l'ancienneté",
       x = "Ancienneté",
       y = "Moyenne du Salaire Annuel",
       fill = "Ancienneté") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

Le graphique "Moyenne des salaires en fonction de l'ancienneté" illustre comment l'expérience professionnelle accumulée influence la rémunération moyenne des employés. L'ancienneté, divisée en segments d'un an, sert de mesure pour établir une corrélation potentielle entre le temps passé dans une organisation ou un secteur et le salaire moyen perçu.

Les employés avec moins d'un an d'expérience, représentés par la barre rouge, perçoivent les salaires les plus bas de l'échelle, ce qui est attendu pour des positions souvent associées à des rôles débutants ou en phase d'apprentissage. À mesure que l'ancienneté augmente, les barres s'élèvent progressivement : la tranche d'un à deux ans (verte) montre une augmentation modeste du salaire, suggérant un premier palier d'évolution salariale.

Ce phénomène de croissance se poursuit de manière plus marquée pour les tranches de deux à trois ans (bleue) et de trois à quatre ans (violet), où l'on observe un bond significatif dans les salaires moyens. Cela peut refléter les promotions, les augmentations méritées ou l'acquisition de compétences spécialisées qui sont souvent récompensées par des ajustements salariaux positifs.

Curieusement, la tranche des employés les plus anciens, ceux ayant entre quatre et cinq ans d'expérience (rose), bien qu'affichant un salaire moyen élevé, ne représente pas le sommet de l'échelle salariale. Ceci peut indiquer une stabilisation des salaires ou peut-être une saturation dans certaines industries où l'expérience supplémentaire au-delà d'un certain point n'entraîne pas nécessairement une augmentation significative de la rémunération.

En synthèse, ce graphique démontre un lien apparent entre l'ancienneté et le salaire moyen, soulignant l'importance de l'expérience dans la progression de carrière. Il suggère que l'accumulation d'années de service peut être un facteur déterminant dans l'évolution des salaires, bien que l'impact de l'ancienneté puisse plafonner après un certain temps.


###Distribution du salaire selon le secteur

```{r etude 1}

library(ggplot2)

# Vérifiez toutes les valeurs uniques pour identifier les valeurs non désirées
unique(raw_data$Secteur)

# Filtrez le DataFrame pour ne garder que les lignes avec "Privé" et "Public"
filtered_data <- raw_data[raw_data$Secteur %in% c("Prive", "Public"), ]

# Continuez avec la création du graphique ggplot
ggplot(filtered_data, aes(x = Secteur, y = Salaire_annuel, fill = Secteur)) +
  geom_boxplot(
    width = 0.8,
    notch = TRUE,
    outlier.shape = NA,
    color = "black",
    alpha = 0.7
  ) +
  scale_fill_manual(values = c("Prive" = "pink", "Public" = "green")) +
  labs(
    title = "Distribution des salaires par secteur (Privé et Public)",
    x = "Secteur",
    y = "Salaire Annuel"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_blank()
  )



```


### Distribution du salaire en fonction de France/étranger
```{r etude10}
ggplot(raw_data, aes(x = factor(France), y = Salaire_annuel, fill = factor(France))) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8, alpha = 0.7) +
  labs(
    title = "Comparaison des salaires en fonction du pays",
    x = "Pays",
    y = "Salaire Annuel",
    fill = "Pays"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_text(size = 10)
  )
```

Le diagramme "Comparaison des salaires en fonction du pays" met en lumière les différences entre les salaires annuels en France et à l'étranger. Les violons représentent la densité des données, montrant où les salaires se concentrent pour chaque groupe.

Pour "Étranger", le violon s'élargit considérablement au milieu, indiquant que la majorité des salaires se situe autour de ce point central, qui est nettement supérieur à celui de la France. Cela suggère que le salaire médian à l'étranger est plus élevé. La largeur du violon à l'étranger suggère également une plus grande variabilité des salaires, avec des valeurs extrêmes plus hautes illustrées par la longue queue supérieure. Cela peut indiquer que les opportunités de salaires élevés sont plus nombreuses à l'étranger ou que certains secteurs ou rôles internationaux offrent des primes significatives.

En revanche, le violon représentant la France montre une concentration plus étroite des salaires, avec une densité plus élevée autour de la médiane et moins de valeurs extrêmes. La queue supérieure est plus courte, ce qui indique que moins de travailleurs atteignent les salaires les plus élevés comparativement à leurs homologues à l'étranger.

Cette visualisation pourrait refléter les dynamiques du marché du travail global, où le travail à l'étranger peut être associé à des rémunérations plus compétitives ou à des avantages liés à l'expatriation. Elle pourrait aussi pointer vers des différences dans la structure des industries, des niveaux de vie ou des politiques salariales entre la France et d'autres pays.



### Distribution du salaire en fonction du pays à l'étranger
```{r etude11, warning=FALSE}
library(ggplot2)

# Calcul de la médiane des salaires par pays
median_salaries <- tapply(raw_data_filtered$Salaire_annuel, raw_data_filtered$Pays, median)
median_order <- names(sort(median_salaries))

# Création d'un facteur pour l'ordre des pays par médiane
emploiFactor <- factor(raw_data_filtered$Pays, levels = median_order)

# Création du diagramme en bâtonnets
ggplot(raw_data_filtered, aes(x = emploiFactor, y = Salaire_annuel, fill = emploiFactor)) +
  geom_bar(stat = "summary", fun = "median", color = "white", size = 0.5) +
  theme_minimal() +  # Fond blanc
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +  # Suppression des lignes de grille
  labs(title = "Médiane des Salaires par Pays", x = "Pays", y = "Médiane du Salaire Annuel",
       fill = "Pays")  # Légende pour les couleurs des pays


```


Idem que les années précédentes.

### Distribution des salaires en fonction de la région

```{r distributionRegion}

library(ggplot2)

# Remove rows with non-finite values in Salaire_annuel
raw_data <- raw_data[!is.na(raw_data$Salaire_annuel) & is.finite(raw_data$Salaire_annuel), ]

# Remove rows with non-finite values in other numeric columns if needed
# raw_data <- raw_data[complete.cases(raw_data[, numeric_cols]), ]

# Calculate average salary by region
avg_salary_by_region <- tapply(raw_data$Salaire_annuel, raw_data$Region, mean)
max_avg_salary_region <- names(which.max(avg_salary_by_region))

# Define a color palette for each region
color_palette <- rainbow(length(unique(raw_data$Region)))

# Plotting the distribution of salaries based on region as a pie chart
ggplot(raw_data, aes(x = "", y = Salaire_annuel, fill = Region)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  theme_void() +  # Removes unnecessary elements
  labs(title = "Répartition des salaires par région",
       fill = "Région",
       y = "Salaire Annuel") +
  scale_fill_manual(values = ifelse(raw_data$Region == max_avg_salary_region, "red", color_palette))  # Highlight region with highest average salary




```

Idem que les années précédentes.
