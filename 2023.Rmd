# Etude données 2023

## Récupération des données

```{r chargementData}
# Trying ISO-8859-1
raw_data <- read.csv("data/data_2023.csv", sep = ",", fileEncoding = "UTF-8")
```


Définir toutes les données comme caractère (variable qualitative) sauf le salaire

```{r colonnesQualitative}
# Lists specifying which columns to convert to factors and numeric
factor_cols <- c("Date", "Identifiant", "Genre", "Annee_diplome","Type_formation","Filiere","Situation_actuelle","Secteur","Nature_contrat", "Pays","Region", "Pays_etranger", "Taille_entreprise", "Nom_entreprise", "Departement", "Intitule_poste", "Secteur_activite")
numeric_cols <- c("Anciennete","Salaire_annuel_brut", "Salaire_annuel_brut_primes", "Responsabilite_hierarchique", "Responsabilite_budget", "Responsabilite_equipe", "Responsabilite_projet", "Satisfaction_globale", "Satisfaction_relations", "Satisfaction_salaire", "Satisfaction_autonomie", "Satisfaction_localisation")

# Convert columns to factors
raw_data[factor_cols] <- lapply(raw_data[factor_cols], as.factor)

# Convert columns to numeric
raw_data[numeric_cols] <- sapply(raw_data[numeric_cols], as.numeric)
```

```{r affichageSummaryRawData, eval=FALSE}
summary(raw_data)
```

Avec ces valeurs on peut déduire beaucoup de choses... 

### Fonction de filtre 
Ceci est une fonction utilisé après pour retirer différentes lignes en fonction des valeurs dans une certain colonne. (équivalent d'un select where)
```{r fonctionFiltre}
remove_rows_by_value <- function(data, column_name, value_to_remove) {
  data_filtered <- subset(data, !(data[[column_name]] == value_to_remove))
  return(data_filtered)
}
```

## Première étude 

### Disparité homme/femme - toute formation confondue
```{r etude1}
ggplot(raw_data, aes(x = Genre, y = Salaire_annuel_brut_primes, fill = Genre)) +
  geom_boxplot(width = 0.5, notch = TRUE, outlier.shape = NA) +
  labs(title = "Différences de salaire par genre",
       x = "Genre",
       y = "Salaire Annuel") +
  theme_minimal() +
  theme(legend.position = "none")
```

Le graphique intitulé "Différences de salaire par genre" représente un boxplot classique, qui met en évidence la distribution des salaires annuels entre les femmes et les hommes. À première vue, il suggère une légère disparité salariale entre les genres, avec les médianes indiquant que les hommes ont tendance à gagner plus que les femmes dans cet échantillon. 

Les médianes de chaque groupe — représentées par la ligne centrale des boîtes — sont cruciales pour cette observation. La médiane pour le groupe des femmes semble être inférieure à celle du groupe des hommes. Il est important de noter que la médiane est souvent préférée à la moyenne pour une telle analyse, car elle est moins sensible aux valeurs extrêmes qui pourraient fausser les résultats.

En examinant la taille des boîtes, qui illustrent l'écart interquartile, nous observons une similitude dans la dispersion des salaires entre les deux groupes. Cela signifie que la moitié centrale des salaires s'étend sur une plage similaire pour les deux genres, suggérant que, mis à part la médiane, les distributions des salaires sont relativement comparables.

En conclusion, ce graphique révèle une tendance où les hommes semblent avoir un avantage salarial par rapport aux femmes dans l'échantillon étudié. Néanmoins, la similarité des distributions suggère que les écarts de salaires, au-delà de la médiane, ne sont pas marqués par des différences extrêmes. Pour une analyse complète, il serait judicieux de prendre en compte d'autres variables qui pourraient influencer ces résultats et de réaliser des tests statistiques pour évaluer la significativité des différences observées.


### Disparité sur les dates d'optention du diplôme

```{r etude2}
ggplot(raw_data, aes(x = Salaire_annuel_brut_primes, fill = as.factor(Annee_diplome))) +
  geom_density(alpha = 0.5) +
  labs(title = "Distribution des salaires par année de diplôme",
       x = "Salaire Annuel",
       fill = "Année de Diplôme") +
  theme_minimal()
```

Le graphique en question, "Distribution des salaires par année de diplôme", met en lumière les nuances subtiles des trajectoires salariales des diplômés de Polytech Montpellier, sur une période couvrant trois années distinctes. Observons d'abord que les courbes de densité pour les années 2016 et 2017 montrent une forte concentration autour d'une valeur modale, suggérant que la plupart des diplômés de ces années se regroupent autour d'un salaire annuel commun. Ce phénomène pourrait indiquer une certaine stabilité dans les conditions du marché de l'emploi ou dans les politiques de rémunération qui prévalent peu de temps après l'obtention du diplôme.

En revanche, la distribution de 2015 se caractérise par une étendue plus large et une densité plus faible. Ce profil suggère une hétérogénéité salariale plus marquée, qui pourrait être le résultat d'évolutions de carrière diversifiées parmi les diplômés. Après quelques années dans le monde professionnel, il est courant que les diplômés connaissent des chemins différents, influencés par une variété de facteurs tels que les progressions de carrière individuelles, les transitions sectorielles, les formations complémentaires ou les opportunités internationales.

Cette variabilité accrue pour la cohorte de 2015 pourrait également refléter le fait que, avec le temps, certains diplômés bénéficient d'augmentations salariales grâce à des promotions ou des changements d'emploi qui reconnaissent leur expérience et leurs compétences accrues. Parallèlement, d'autres peuvent choisir des voies qui privilégient l'équilibre travail-vie personnelle ou l'engagement social, ce qui pourrait se traduire par des salaires moins élevés. De plus, il est possible que les secteurs d'activité qui embauchaient ces diplômés aient subi des transformations économiques, avec des secteurs en croissance offrant des rémunérations supérieures et d'autres, en décroissance ou en mutation, exerçant une pression à la baisse sur les salaires.

L'analyse de ces distributions révèle donc non seulement les conditions initiales du marché de l'emploi pour les nouveaux diplômés, mais aussi l'impact à long terme des décisions professionnelles, des opportunités de marché et des trajectoires personnelles sur les résultats financiers. Cela souligne l'importance pour les institutions éducatives et les étudiants de considérer les tendances à long terme et les facteurs d'influence sur les salaires, au-delà des premières années suivant la graduation.


### Disparité formation initiale/apprentissage/contrat de professionalisation
```{r etude3}
library(ggplot2)

# Supprimer les lignes où 'Type_formation' est NA ou vide
clean_data <- raw_data[!is.na(raw_data$Type_formation) & raw_data$Type_formation != "", ]

# Créer le graphique avec les données nettoyées
ggplot(clean_data, aes(x = as.factor(Type_formation), y = Salaire_annuel_brut_primes, fill = as.factor(Type_formation))) +
  stat_summary(fun = "mean", geom = "col") +
  labs(title = "Moyenne des salaires par type de formation",
       x = "Type de Formation",
       y = "Moyenne du Salaire Annuel",
       fill = "Type de Formation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Le diagramme représente la moyenne des salaires annuels en fonction du type de formation. Les données montrent clairement que l'apprentissage affiche le salaire moyen le plus élevé parmi les trois catégories, ce qui peut indiquer une valorisation sur le marché du travail des compétences pratiques et de l'expérience acquise à travers ce type de formation. En deuxième position, nous avons les salaires moyens pour les formations initiales, qui sont légèrement inférieurs à ceux de l'apprentissage, mais qui restent néanmoins significatifs. Cela pourrait refléter la reconnaissance de la formation académique traditionnelle. Enfin, la professionalisation affiche le salaire moyen le plus bas des trois, ce qui pourrait suggérer que ces programmes sont soit moins valorisés, soit qu'ils mènent à des secteurs avec des grilles salariales globalement plus basses. Cette hiérarchie des salaires peut être influencée par divers facteurs, tels que la demande du marché pour certaines compétences, la nature des industries employant les diplômés de ces formations, ou encore le niveau de spécialisation requis.



### Disparité des filières

```{r etude4}
ggplot(raw_data, aes(x = Filiere, y = Salaire_annuel_brut_primes, fill = Filiere)) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8) +
  geom_boxplot(width = 0.2, fill = "white", color = "black", outlier.shape = NA) +
  labs(title = "Distribution des salaires par filière",
       x = "Filière",
       y = "Salaire Annuel",
       fill = "Filière") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


### Filtrage des personnes en activité 
```{r filtrage_activite}
filtered_data <- remove_rows_by_value(raw_data, "Situation", "En recherche emploi")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En poursuite d'études (hors thèse) / en formation")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "These")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Sans activité") 
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Volontariat")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En création d'entreprise /reprise d'entreprise")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Etudes")

activite_data <- filtered_data
```



### Disparité par nature du contrat
```{r etude7, warning=FALSE}
library(ggplot2)

# Remplacer 'activite_data' par votre dataframe réel
# Filtrage de certains contrats peu représentatifs
filtered_data <- raw_data[!raw_data$Nature_contrat %in% c("Service à la personne (cours particulier de mathématiques via Acadomia)", "", "Autre", "de cdd a cdi"), ]

# Supposons que les catégories de contrats sont 'CDD', 'CDI', 'Intérim', etc.
# Vous pouvez définir manuellement les couleurs pour chaque catégorie de contrat
couleurs_contrats <- c("CDD" = "#66c2a5", "CDI" = "#fc8d62", "Intérim" = "#8da0cb", 
                       "CDIC" = "#e78ac3", "Contrat local" = "#a6d854", "CTT" = "#e78ac3")

# Diagramme en boîte avec couleurs
ggplot(filtered_data, aes(x = Nature_contrat, y = Salaire_annuel_brut_primes, fill = Nature_contrat)) +
  geom_boxplot() +
  scale_fill_manual(values = couleurs_contrats) +  # Utiliser les couleurs définies précédemment
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Distribution des salaires par type de contrat", x = "Type de Contrat", y = "Salaire Annuel")

```

Le diagramme "Distribution des salaires par type de contrat" présente une comparaison des salaires annuels en fonction des différents contrats de travail. Les contrats à durée indéterminée (CDI) et les contrats à durée déterminée (CDD) sont les plus représentés, avec une médiane indiquant le salaire annuel moyen pour chaque type. Les CDI, généralement associés à une plus grande sécurité de l'emploi, ont une médiane plus élevée et une distribution plus large des salaires, ce qui suggère une variété de postes et de niveaux d'ancienneté. Les CDD, en revanche, montrent une distribution plus serrée, ce qui peut indiquer des salaires plus uniformes et potentiellement plus bas.

On observe également d'autres types de contrats comme les contrats d'apprentissage et les contrats de professionnalisation, qui ont tendance à présenter des salaires inférieurs, conformément à leur nature de formation en milieu professionnel.

Les contrats locaux et les contrats de travail temporaire (CTT) ont des médianes plus basses, ce qui est cohérent avec la nature temporaire et potentiellement moins rémunératrice de ces emplois. Les stages, avec une médiane encore plus basse, indiquent le statut d'emploi non salarié ou peu rémunéré, souvent lié à l'apprentissage et à la formation.

Ce diagramme illustre la diversité des situations salariales en fonction du type de contrat, reflétant les différences en termes de sécurité d'emploi, d'opportunités de croissance de salaire, et de statut professionnel. Il est important de noter que ces données peuvent varier considérablement en fonction du secteur d'activité, de la région, de l'expérience et de la formation des individus.

### Distribution du salaire en fonction de l'ancienneté 

```{r etude8}

library(ggplot2)

# Création de catégories d'ancienneté (facultatif)
ordered_data$Anciennete_category <- cut(as.numeric(ordered_data$Anciennete), breaks = 5)

# Diagramme en barres pour la moyenne des salaires en fonction de l'ancienneté
ggplot(ordered_data, aes(x = Anciennete_category, y = Salaire_annuel, fill = Anciennete_category)) +
  geom_bar(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Moyenne des salaires en fonction de l'ancienneté",
       x = "Ancienneté",
       y = "Moyenne du Salaire Annuel",
       fill = "Ancienneté") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

Idem que les années précédentes.


###Distribution du salaire selon le secteur

```{r etude 1}

library(ggplot2)

# Supposons que 'Secteur' est la colonne qui indique si une personne travaille dans le secteur privé ou public.
# Nous allons exclure les non-salariés qui, dans cet exemple, sont marqués comme 'Non salarie(e)' dans la colonne 'Secteur'.

filtered_data <- raw_data[raw_data$Secteur != 'Non salarie(e)', ]

# Graphique Boîte à moustaches avec deux couleurs pour le secteur privé et le secteur public
ggplot(filtered_data, aes(x = Secteur, y = Salaire_annuel_brut_primes, fill = Secteur)) +
  geom_boxplot(
    width = 0.8,
    notch = TRUE,
    outlier.shape = NA,
    color = "black", # La couleur des lignes du boxplot
    alpha = 0.7
  ) +
  scale_fill_manual(values = c("Prive" = "pink", "Public" = "green")) + # Deux couleurs pour privé et public
  labs(
    title = "Distribution des salaires par secteur (Privé et Public)",
    x = "Secteur",
    y = "Salaire Annuel"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_blank() # Enlève le titre de la légende
  )



```
Le diagramme en boîte intitulé "Distribution des salaires par secteur (Privé et Public)" offre une visualisation des écarts de rémunération entre le secteur privé, le secteur public et les associations/ONG. Chaque boîte dépeint la répartition des salaires annuels au sein de chaque catégorie, avec une médiane qui divise la boîte en deux parties égales, représentant la valeur centrale des données.

Le secteur privé présente une plage salariale plus large que le secteur public, ce qui pourrait indiquer une plus grande diversité dans les types d'emplois et les niveaux de rémunération au sein du privé. La médiane du secteur privé est légèrement supérieure à celle du public, suggérant que les salaires médians sont généralement plus élevés dans le privé.

Le secteur public montre une distribution des salaires plus concentrée avec moins de valeurs extrêmes, ce qui est cohérent avec des grilles salariales plus réglementées et uniformes.

Les associations et ONG présentent la médiane la plus basse, ainsi qu'une gamme de salaires relativement étroite, ce qui est typique pour le secteur non lucratif où les budgets sont souvent limités et les rémunérations moins compétitives par rapport aux secteurs privé et public.

En général, ce diagramme illustre les différences structurelles de rémunération entre les différents secteurs d'activité, reflétant des réalités économiques, des politiques de rémunération et des missions organisationnelles distinctes.


### Distribution du salaire en fonction de France/étranger
```{r etude10}
ggplot(raw_data, aes(x = factor(Pays), y = Salaire_annuel_brut_primes, fill = factor(Pays))) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8, alpha = 0.7) +
  labs(
    title = "Comparaison des salaires en fonction du pays",
    x = "Pays",
    y = "Salaire Annuel",
    fill = "Pays"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_text(size = 10)
  )
```

Le diagramme "Comparaison des salaires en fonction du pays" est un graphique en forme de violon qui illustre la distribution des salaires annuels entre deux catégories : "Étranger" et "France". Cette forme de représentation permet de visualiser à la fois la répartition de la densité des données (la largeur du violon) et la médiane (la ligne épaisse au centre du violon).

Pour le pays marqué comme "Étranger", le violon est large en son centre, indiquant une concentration élevée des salaires autour de la médiane, mais avec des pointes s'étendant vers des salaires plus élevés et plus bas, ce qui suggère une variabilité significative des salaires à l'étranger.

La catégorie "France", en revanche, montre un violon plus étroit et allongé, avec une médiane plus basse que celle de la catégorie "Étranger". La concentration autour de la médiane est moins prononcée, ce qui implique que les salaires en France sont plus uniformément répartis sur une gamme plus étroite.

Globalement, ce graphique suggère que, bien que la médiane des salaires en France soit inférieure, la distribution des salaires est moins variée qu'à l'étranger. Cela pourrait refléter des différences dans les structures économiques, les niveaux de vie, les politiques de rémunération, ou d'autres facteurs socio-économiques influençant les salaires dans les deux régions.



### Distribution du salaire en fonction du pays à l'étranger
```{r etude11, warning=FALSE}
library(ggplot2)

# Calcul de la médiane des salaires par pays
median_salaries <- tapply(raw_data_filtered$Salaire_annuel, raw_data_filtered$Pays, median)
median_order <- names(sort(median_salaries))

# Création d'un facteur pour l'ordre des pays par médiane
emploiFactor <- factor(raw_data_filtered$Pays, levels = median_order)

# Création du diagramme en bâtonnets
ggplot(raw_data_filtered, aes(x = emploiFactor, y = Salaire_annuel, fill = emploiFactor)) +
  geom_bar(stat = "summary", fun = "median", color = "white", size = 0.5) +
  theme_minimal() +  # Fond blanc
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +  # Suppression des lignes de grille
  labs(title = "Médiane des Salaires par Pays", x = "Pays", y = "Médiane du Salaire Annuel",
       fill = "Pays")  # Légende pour les couleurs des pays


```


Idem que les années précédentes.


### Distribution des salaires en fonction de la région

```{r distributionRegion}

library(ggplot2)

# Remove rows with non-finite values in Salaire_annuel
raw_data <- raw_data[!is.na(raw_data$Salaire_annuel_brut_primes) & is.finite(raw_data$Salaire_annuel_brut_primes), ]

# Remove rows with non-finite values in other numeric columns if needed
# raw_data <- raw_data[complete.cases(raw_data[, numeric_cols]), ]

# Calculate average salary by region
avg_salary_by_region <- tapply(raw_data$Salaire_annuel_brut_primes, raw_data$Region, mean)
max_avg_salary_region <- names(which.max(avg_salary_by_region))

# Define a color palette for each region
color_palette <- rainbow(length(unique(raw_data$Region)))

# Plotting the distribution of salaries based on region as a pie chart
ggplot(raw_data, aes(x = "", y = Salaire_annuel_brut_primes, fill = Region)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  theme_void() +  # Removes unnecessary elements
  labs(title = "Répartition des salaires par région",
       fill = "Région",
       y = "Salaire Annuel") +
  scale_fill_manual(values = ifelse(raw_data$Region == max_avg_salary_region, "red", color_palette))  # Highlight region with highest average salary




```

Idem que les années précédentes.