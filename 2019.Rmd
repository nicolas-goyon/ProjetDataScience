# Etude données 2019

## Récupération des données

```{r chargementData}
# Trying ISO-8859-1
raw_data <- read.csv("data/data_2019.csv", sep = ";", fileEncoding = "UTF-8")
```


Définir toutes les données comme caractère (variable qualitative) sauf le salaire

```{r colonnesQualitative}
# Lists specifying which columns to convert to factors and numeric
factor_cols <- c("Date", "identifiant", "Genre", "Annee_diplome","Type_formation","Filiere","Situation","Secteur","Nature_contrat", "France","Region", "Pays", "Taille_entreprise", "Nom_entreprise", "Departement", "Intitule_poste", "Secteur_activite")
numeric_cols <- c("Anciennete", "Salaire_annuel", "Responsabilite_hierarchique", "Responsabilite_budget", "Responsabilite_equipe", "Responsabilite_projet", "Satisfaction_globale", "Saitisfaction_relations", "Satisfaction_salaire", "Satisfaction_autonomie", "Satisfaction_localisation")

# Convert columns to factors
raw_data[factor_cols] <- lapply(raw_data[factor_cols], as.factor)

# Convert columns to numeric
raw_data[numeric_cols] <- lapply(raw_data[numeric_cols], as.numeric)
```

```{r affichageSummaryRawData, echo=FALSE, eval=FALSE}
summary(raw_data)
```

Avec ces valeurs on peut déduire beaucoup de choses... 


## Première étude 

### Disparité homme/femme - toute formation confondue
```{r etude1}
boxplot(raw_data$Salaire_annuel ~ raw_data$Genre)
```

En 2019, on ne remarque pas de différence significative entre les hommes et les femmes.




### Disparité sur les dates d'optention du diplôme

```{r etude2}
boxplot(raw_data$Salaire_annuel ~ raw_data$Annee_diplome)
```

L'année d'optention dans ces données n'ont pas l'air d'avoir un grand impact sur les salaires.




### Disparité formation initiale/apprentissage/contrat de professionalisation
```{r etude3}
boxplot(raw_data$Salaire_annuel ~ raw_data$Type_formation)
```

Les apprentis et les élèves en formation initiale semblent avoir des salaire similaires. Tandis que ceux en contrat de professionnalisation ont des salaires en moyenne similaire avec une plus grande disparité haute.




### Disparité des filières

```{r etude4}
boxplot(raw_data$Salaire_annuel ~ raw_data$Filiere)
```

En 2019, les salaires se basent principalement entre 30 000 et 40 000€ sans grosses variations.



### Filtrage des personnes en activité 
```{r filtrage_activite}
filtered_data <- remove_rows_by_value(raw_data, "Situation", "En recherche emploi")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En poursuite d'études (hors thèse) / en formation")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "These")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Sans activité") 
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Volontariat")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En création d'entreprise /reprise d'entreprise")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Etudes")

activite_data <- filtered_data
```



### Disparité par nature du contrat
```{r etude7, warning=FALSE}


# Filtrage de certains contrat peu représentatif
filtered_data <- remove_rows_by_value(activite_data, "Nature_contrat", "Service à la personne (cours particulier de mathématiques via Acadomia)")
filtered_data <- remove_rows_by_value(filtered_data, "Nature_contrat", "")

ggplot(filtered_data, aes(x = Nature_contrat, y = Salaire_annuel)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Salary Distribution by Contract Type", x = "Contract Type", y = "Salary")

```

On peut remarquer que les cdi et contrats locaux ont un net avantages par rapport aux CDD et CTT.



### Distribution du salaire en fonction de l'ancienneté 

```{r etude8}



ordered_data <- raw_data[order(as.numeric(raw_data$Anciennete)), ]

boxplot(raw_data$Salaire_annuel ~ as.numeric(raw_data$Anciennete), data = ordered_data)
```

Il ne semble à priori pas avoir de lien entre l'ancienneté et le salaire sur les deux premières années, après cela, il manque des informations.



### Distribution du salaire en fonction de l'ancienneté (Groupée)
```{r etude9}
monthGroup <- cut(as.numeric(raw_data$Anciennete),
                               breaks = c(0, 6, 12, 24, Inf),
                               labels = c("1-6", "7-12", "13-24", "25+"),
                               right = FALSE)


boxplot(raw_data$Salaire_annuel ~ monthGroup, data = raw_data)
```

En regroupant l'ancienneté sur des périodes de 6 mois, on ne remarque aucun changement significatif.


### Distribution du salaire en fonction de France/étranger
```{r etude10}
boxplot(raw_data$Salaire_annuel ~ raw_data$France)
```

Ici la France à tendance à être moins bien payé que l'étranger ainsi que l'étranger ayant une plus grande dispertion de salaires contraitement à l'étranger où les salaires sont plus rassemblés.




### Distribution du salaire en fonction du pays à l'étranger
```{r etude11, warning=FALSE}
raw_data_filtered <- raw_data[complete.cases(raw_data$Pays) & raw_data$Pays != "" & !grepl("^\\s*$", raw_data$Pays) & !is.na(raw_data$Salaire_annuel), ]


median_salaries <- tapply(raw_data_filtered$Salaire_annuel, raw_data_filtered$Pays, median)
median_order <- names(sort(median_salaries))

emploiFactor <- factor(raw_data_filtered$Pays, levels = median_order)



ggplot(raw_data_filtered, aes(x = emploiFactor, y = Salaire_annuel)) +
  geom_boxplot(na.rm = TRUE) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Salary Distribution by Country", x = "Country", y = "Salary")
```


Ici les données sont trop faible pour de réelles interprétations, sauf pour l'Irlande, le Royaume-Uni, Canada et Suisse où les salaires. Le Royaume-Uni semblant être proche de la France, cependant l'Irlande, Canada et Suisse ayant un salaire nêtement plus grand.


<<<<<<< Updated upstream
### Distribution des salaires en fonction de la région

```{r distributionRegion}
# Remove rows with non-finite values in Salaire_annuel
raw_data <- raw_data[!is.na(raw_data$Salaire_annuel) & is.finite(raw_data$Salaire_annuel), ]

# Remove rows with non-finite values in other numeric columns if needed
# raw_data <- raw_data[complete.cases(raw_data[, numeric_cols]), ]


ordered_regions <- names(sort(tapply(raw_data$Salaire_annuel, raw_data$Region, median)))


# Plotting the distribution of salaries based on region
ggplot(raw_data, aes(x = Region, y = Salaire_annuel)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(limits = ordered_regions)+
  labs(title = "Distribution des salaires en fonction de la région",
       x = "Région",
       y = "Salaire Annuel")

```

Le minimum étant pour la Corse avec 30 000€/an tandis-que l'ile-de-France est plus proche des 40 000€ à 45 000€, il y a un lien mais aucune région ne semble se distringuer particulièrement.

