# Etude données 2019

## Récupération des données

```{r chargementData}
# Trying ISO-8859-1
raw_data <- read.csv("data/data_2019.csv", sep = ";")
```


Définir toutes les données comme caractère (variable qualitative) sauf le salaire

```{r colonnesQualitative}
# Lists specifying which columns to convert to factors and numeric
factor_cols <- c("Date", "identifiant", "Genre", "Annee_diplome","Type_formation","Filiere","Situation","Secteur","Nature_contrat", "France","Region", "Pays", "Taille_entreprise", "Nom_entreprise", "Departement", "Intitule_poste", "Secteur_activite")
numeric_cols <- c("Anciennete", "Salaire_annuel", "Responsabilite_hierarchique", "Responsabilite_budget", "Responsabilite_equipe", "Responsabilite_projet", "Satisfaction_globale", "Saitisfaction_relations", "Satisfaction_salaire", "Satisfaction_autonomie", "Satisfaction_localisation")

# Convert columns to factors
raw_data[factor_cols] <- lapply(raw_data[factor_cols], as.factor)

# Convert columns to numeric
raw_data[numeric_cols] <- lapply(raw_data[numeric_cols], as.numeric)
```

```{r affichageSummaryRawData, eval=FALSE}
summary(raw_data)
```
Nous allons analyser le salaire en fonction des différents paramètres.

### Fonction de filtre 
Ceci est une fonction utilisé après pour retirer différentes lignes en fonction des valeurs dans une certain colonne. (équivalent d'un select where)
```{r fonctionFiltre}
remove_rows_by_value <- function(data, column_name, value_to_remove) {
  data_filtered <- subset(data, !(data[[column_name]] == value_to_remove))
  return(data_filtered)
}
```

## Première étude 

### Disparité homme/femme - toute formation confondue
```{r etude1}
ggplot(raw_data, aes(x = Genre, y = Salaire_annuel, fill = Genre)) +
  geom_boxplot(width = 0.5, notch = TRUE, outlier.shape = NA) +
  labs(title = "Différences de salaire par genre",
       x = "Genre",
       y = "Salaire Annuel") +
  theme_minimal() +
  theme(legend.position = "none")
```

Le graphique intitulé "Différences de salaire par genre" présente deux boxplots qui comparent les salaires annuels entre les femmes et les hommes. Chaque boxplot montre la médiane des salaires, les quartiles et les variations au sein de chaque genre.

Du côté des femmes, le boxplot rouge indique une médiane qui se situe plutôt au centre de la boîte, avec des "moustaches" qui s'étendent pour montrer la gamme complète des salaires. La répartition semble relativement étroite, suggérant que la majorité des salaires féminins se concentre autour de la médiane sans variations extrêmes.

Pour les hommes, le boxplot cyan montre également une médiane bien définie, et l'étendue des salaires semble légèrement plus large que celle des femmes, comme indiqué par les moustaches plus longues. Cela pourrait impliquer que les salaires masculins varient plus et que certains hommes peuvent atteindre des salaires plus élevés par rapport à leurs homologues féminins.

La comparaison des deux boxplots révèle une médiane de salaire légèrement plus élevée pour les hommes que pour les femmes, ce qui soulève des questions sur l'égalité des salaires et la représentation des genres dans différents rôles ou niveaux de responsabilité au sein de l'économie.

Ce graphique illustre l'existence d'un écart salarial entre les genres dans le contexte étudié. Alors que les boxplots ne fournissent pas les raisons sous-jacentes à cet écart, ils signalent une différence qui pourrait être due à une variété de facteurs, y compris mais non limités à la discrimination de genre, les différences dans les choix de carrière, l'éducation, l'expérience professionnelle ou le temps de travail.

### Disparité sur les dates d'optention du diplôme

```{r etude2}
ggplot(raw_data, aes(x = Salaire_annuel, fill = as.factor(Annee_diplome))) +
  geom_density(alpha = 0.5) +
  labs(title = "Distribution des salaires par année de diplôme",
       x = "Salaire Annuel",
       fill = "Année de Diplôme") +
  theme_minimal()
```

Le graphique "Distribution des salaires par année de diplôme" dépeint les distributions des salaires annuels pour trois cohortes de diplômés: 2016, 2017 et 2018. Les courbes de densité illustrent où les salaires se concentrent pour chaque groupe.

Pour les diplômés de 2018, la courbe de densité est centrée vers des salaires plus bas, indiquant que ceux qui sont le plus récemment entrés sur le marché du travail ont tendance à commencer avec des salaires inférieurs. Cela peut s'expliquer par le fait que les individus les plus récemment diplômés sont souvent au début de leur carrière et peuvent ne pas avoir encore bénéficié d'augmentations ou de promotions.

En remontant dans le temps, les courbes des années 2017 et 2016 démontrent que les pics se déplacent progressivement vers des salaires plus élevés. Cette tendance suggère que, avec le temps, les diplômés gagnent en expérience et progressent dans leur carrière, ce qui se traduit par des salaires plus élevés. Ce phénomène reflète une évolution rapide dans les premières années suivant l'obtention du diplôme, où les augmentations de salaire peuvent être plus fréquentes et substantielles.

De plus, d'année en année, les courbes montrent des pics moins aigus et sont plus étalées, indiquant une distribution des salaires plus semblable parmi les diplômés. Pour les diplômés de 2018, la courbe est relativement pointue, ce qui suggère une grande variabilité des salaires au sein de cette cohorte, avec moins de concentration autour d'un salaire typique ou médian. Cela pourrait signifier que le marché du travail est devenu plus dynamique ou incertain, avec des opportunités et des trajectoires professionnelles variées qui se traduisent par une variabilité accrue des salaires. 

En résumé, cette analyse suggère qu'avec le temps, les diplômés tendent à voir une amélioration de leur situation salariale et que le marché du travail offre une diversité croissante de rémunérations à mesure que les diplômés s'établissent et avancent dans leurs carrières respectives.


### Disparité formation initiale/apprentissage/contrat de professionalisation
```{r etude3}
library(ggplot2)

# Supprimer les lignes où 'Type_formation' est NA ou vide
clean_data <- raw_data[!is.na(raw_data$Type_formation) & raw_data$Type_formation != "", ]

# Créer le graphique avec les données nettoyées
ggplot(clean_data, aes(x = as.factor(Type_formation), y = Salaire_annuel, fill = as.factor(Type_formation))) +
  stat_summary(fun = "mean", geom = "col") +
  labs(title = "Moyenne des salaires par type de formation",
       x = "Type de Formation",
       y = "Moyenne du Salaire Annuel",
       fill = "Type de Formation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Le graphique "Moyenne des salaires par type de formation" présente une comparaison visuelle des salaires moyens pour trois types de formation : apprentissage, formation initiale et professionnalisation. Chaque barre, colorée différemment, représente la moyenne salariale annuelle associée à chaque type de formation.

La barre rouge, correspondant à l'apprentissage, affiche une moyenne salariale qui semble être la plus haute des trois. Cela peut s'expliquer par le fait que l'apprentissage combine souvent travail et études. Ainsi, l'acquisition d'expérience durant les études favorise un salaire plus élevé.

La formation initiale, représentée en vert, montre une moyenne salariale légèrement supérieure à celle de l'apprentissage. Cette catégorie inclut typiquement les étudiants sortant directement de l'éducation secondaire ou supérieure et entrant sur le marché du travail, ce qui peut conduire à des salaires de début de carrière standard.

La professionnalisation, en bleu, présente la moyenne salariale la plus élevée des trois catégories. Cela peut refléter la valeur du marché pour les formations professionnelles spécialisées, qui sont souvent conçues pour répondre directement aux besoins des industries et peuvent conduire à une insertion professionnelle avec des salaires plus compétitifs.

Ce graphique suggère que le type de formation a un impact significatif sur les salaires moyens. Les formations professionnelles, axées sur l'acquisition de compétences spécifiques et immédiatement applicables, semblent offrir les meilleures perspectives salariales moyennes, tandis que les parcours plus traditionnels ou les formations en apprentissage offrent des salaires moyens inférieurs.



### Disparité des filières

```{r etude4}
ggplot(raw_data, aes(x = Filiere, y = Salaire_annuel, fill = Filiere)) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8) +
  geom_boxplot(width = 0.2, fill = "white", color = "black", outlier.shape = NA) +
  labs(title = "Distribution des salaires par filière",
       x = "Filière",
       y = "Salaire Annuel",
       fill = "Filière") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


### Filtrage des personnes en activité 
```{r filtrage_activite}
filtered_data <- remove_rows_by_value(raw_data, "Situation", "En recherche emploi")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En poursuite d'études (hors thèse) / en formation")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "These")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Sans activité") 
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Volontariat")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "En création d'entreprise /reprise d'entreprise")
filtered_data <- remove_rows_by_value(filtered_data, "Situation", "Etudes")

activite_data <- filtered_data
```



### Disparité par nature du contrat
```{r etude7, warning=FALSE}
library(ggplot2)

# Filtrage des données en excluant certaines catégories
filtered_data <- subset(raw_data, !Nature_contrat %in% c("Apprentissage", "Autre", "ile-de-France"))

# Supposons que les catégories de contrats sont 'CDD', 'CDI', 'Intérim', etc.
# Vous pouvez définir manuellement les couleurs pour chaque catégorie de contrat
couleurs_contrats <- c("CDD" = "#66c2a5", "CDI" = "#fc8d62", "Intérim" = "#8da0cb", 
                       "Stage" = "#e78ac3", "Alternance" = "#a6d854", "CTT" = "#e78ac3", "Contrat local"= "turquoise", "VIE"= "purple", "Contrat d'expatriation"= "blue")

# Diagramme en boîte avec couleurs
ggplot(filtered_data, aes(x = Nature_contrat, y = Salaire_annuel, fill = Nature_contrat)) +
  geom_boxplot() +
  scale_fill_manual(values = couleurs_contrats) +  # Utiliser les couleurs définies précédemment
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) +
  labs(title = "Distribution des salaires par type de contrat", x = "Type de Contrat", y = "Salaire Annuel")

```

Le graphique intitulé "Distribution des salaires par type de contrat" fournit une comparaison des salaires annuels en fonction de la nature du contrat de travail. À travers des boxplots, il distingue clairement trois types de contrats : les CDD (contrats à durée déterminée), les CDI (contrats à durée indéterminée) et les CTT (contrats de travail temporaire), chacun représenté par une couleur distincte.

Le CDI, illustré en orange, présente une médiane de salaire supérieure à celle des deux autres types de contrats, indiquant que les employés sous CDI ont en moyenne des salaires plus élevés. La dispersion des salaires dans cette catégorie est également plus large, ce qui suggère une gamme de salaires allant des niveaux débutants aux positions très rémunérées. Les points isolés au-dessus du boxplot principal indiquent l'existence de salaires bien au-delà de la norme, soulignant la présence d'opportunités hautement rémunératrices au sein des CDI.

Les CDD, représentés en turquoise, montrent une concentration plus étroite des salaires, avec une médiane inférieure à celle des CDI. Cette concentration révèle une moindre variabilité salariale, ce qui peut être attribué à la nature temporaire et souvent plus précaire de ces contrats.

Quant aux CTT, affichés en rose, ils arborent la médiane la plus basse et la distribution des salaires la plus resserrée, ce qui indique non seulement des salaires généralement inférieurs mais aussi une moindre variation dans les rémunérations offertes. Cela pourrait refléter les limitations inhérentes aux emplois temporaires, qui offrent moins d'opportunités pour des salaires élevés.

En résumé, le type de contrat apparaît comme un facteur déterminant des perspectives salariales. Les CDI semblent offrir des salaires plus élevés et une plus grande variabilité, reflétant la sécurité et les possibilités de carrière à long terme. Les CDD et les CTT présentent des profils de rémunération plus modestes, avec des CTT particulièrement restreints dans leur potentiel salarial. Pour les individus qui évaluent leurs options d'emploi, cette visualisation des données salariales pourrait être un outil précieux pour orienter leurs décisions professionnelles.


### Distribution du salaire en fonction de l'ancienneté 

```{r etude8}

library(ggplot2)

# Création de catégories d'ancienneté (facultatif)
ordered_data$Anciennete_category <- cut(as.numeric(ordered_data$Anciennete), breaks = 5)

# Diagramme en barres pour la moyenne des salaires en fonction de l'ancienneté
ggplot(ordered_data, aes(x = Anciennete_category, y = Salaire_annuel, fill = Anciennete_category)) +
  geom_bar(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Moyenne des salaires en fonction de l'ancienneté",
       x = "Ancienneté",
       y = "Moyenne du Salaire Annuel",
       fill = "Ancienneté") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))



```

Le graphique "Moyenne des salaires en fonction de l'ancienneté" illustre comment l'expérience professionnelle accumulée influence la rémunération moyenne des employés. L'ancienneté, divisée en segments d'un an, sert de mesure pour établir une corrélation potentielle entre le temps passé dans une organisation ou un secteur et le salaire moyen perçu.

Les employés avec moins d'un an d'expérience, représentés par la barre rouge, perçoivent les salaires les plus bas de l'échelle, ce qui est attendu pour des positions souvent associées à des rôles débutants ou en phase d'apprentissage. À mesure que l'ancienneté augmente, les barres s'élèvent progressivement : la tranche d'un à deux ans (verte) montre une augmentation modeste du salaire, suggérant un premier palier d'évolution salariale.

Ce phénomène de croissance se poursuit de manière plus marquée pour les tranches de deux à trois ans (bleue) et de trois à quatre ans (violet), où l'on observe un bond significatif dans les salaires moyens. Cela peut refléter les promotions, les augmentations méritées ou l'acquisition de compétences spécialisées qui sont souvent récompensées par des ajustements salariaux positifs.

Curieusement, la tranche des employés les plus anciens, ceux ayant entre quatre et cinq ans d'expérience (rose), bien qu'affichant un salaire moyen élevé, ne représente pas le sommet de l'échelle salariale. Ceci peut indiquer une stabilisation des salaires ou peut-être une saturation dans certaines industries où l'expérience supplémentaire au-delà d'un certain point n'entraîne pas nécessairement une augmentation significative de la rémunération.

En synthèse, ce graphique démontre un lien apparent entre l'ancienneté et le salaire moyen, soulignant l'importance de l'expérience dans la progression de carrière. Il suggère que l'accumulation d'années de service peut être un facteur déterminant dans l'évolution des salaires, bien que l'impact de l'ancienneté puisse plafonner après un certain temps.


###Distribution du salaire selon le secteur

```{r etude 1}

library(ggplot2)

# Vérifiez toutes les valeurs uniques pour identifier les valeurs non désirées
unique(raw_data$Secteur)

# Filtrez le DataFrame pour ne garder que les lignes avec "Privé" et "Public"
filtered_data <- raw_data[raw_data$Secteur %in% c("Prive", "Public"), ]

# Continuez avec la création du graphique ggplot
ggplot(filtered_data, aes(x = Secteur, y = Salaire_annuel, fill = Secteur)) +
  geom_boxplot(
    width = 0.8,
    notch = TRUE,
    outlier.shape = NA,
    color = "black",
    alpha = 0.7
  ) +
  scale_fill_manual(values = c("Prive" = "pink", "Public" = "green")) +
  labs(
    title = "Distribution des salaires par secteur (Privé et Public)",
    x = "Secteur",
    y = "Salaire Annuel"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_blank()
  )



```





### Distribution du salaire en fonction de France/étranger
```{r etude10}
ggplot(raw_data, aes(x = factor(France), y = Salaire_annuel, fill = factor(France))) +
  geom_violin(trim = FALSE, scale = "width", width = 0.8, alpha = 0.7) +
  labs(
    title = "Comparaison des salaires en fonction du pays",
    x = "Pays",
    y = "Salaire Annuel",
    fill = "Pays"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "bottom",
    legend.title = element_text(size = 10)
  )
```

Le graphique "Comparaison des salaires en fonction du pays" montre deux graphiques en violon pour les salaires annuels en France et à l'étranger. Ces graphiques en violon combinent des éléments de boîtes à moustaches et de densité de probabilité pour montrer la distribution des salaires.

Le violon pour "Étranger" est plus large et présente une forme centrée vers le haut, indiquant une distribution avec une moyenne plus élevée et une variabilité plus grande des salaires. Cela suggère que les salaires à l'étranger ne sont pas seulement variés, mais comprennent également des valeurs élevées, ce qui peut refléter des différences dans les normes économiques, les structures de rémunération, ou des niveaux de vie plus élevés qui nécessitent des salaires supérieurs.

Pour la France, le violon est plus étroit avec une médiane plus basse et une distribution des salaires moins large, indiquant que les salaires sont généralement plus bas et moins dispersés. Cela pourrait être le reflet de politiques salariales plus homogènes ou de différences dans les secteurs économiques entre la France et les pays étrangers.

La distribution plus large et la médiane plus élevée à l'étranger pourraient également indiquer l'existence de secteurs d'emploi hautement rémunérateurs ou le fait que des expatriés français puissent bénéficier de primes et d'avantages liés à leur statut à l'étranger. En revanche, la concentration des salaires plus basse et la médiane inférieure en France pourraient suggérer une cohésion plus forte des politiques salariales ou une prévalence de secteurs moins rémunérateurs.




### Distribution du salaire en fonction du pays à l'étranger
```{r etude11, warning=FALSE}
library(ggplot2)

# Calcul de la médiane des salaires par pays
median_salaries <- tapply(raw_data_filtered$Salaire_annuel, raw_data_filtered$Pays, median)
median_order <- names(sort(median_salaries))

# Création d'un facteur pour l'ordre des pays par médiane
emploiFactor <- factor(raw_data_filtered$Pays, levels = median_order)

# Création du diagramme en bâtonnets
ggplot(raw_data_filtered, aes(x = emploiFactor, y = Salaire_annuel, fill = emploiFactor)) +
  geom_bar(stat = "summary", fun = "median", color = "white", size = 0.5) +
  theme_minimal() +  # Fond blanc
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()) +  # Suppression des lignes de grille
  labs(title = "Médiane des Salaires par Pays", x = "Pays", y = "Médiane du Salaire Annuel",
       fill = "Pays")  # Légende pour les couleurs des pays


```


Le graphique "Comparaison des salaires en fonction du pays" utilise des graphiques en violon pour illustrer la distribution des salaires annuels en France et à l'étranger. 

Le graphique en violon pour "Étranger", teinté de rouge, montre une large base et un sommet élevé, indiquant une grande variété dans la distribution des salaires avec une densité significative autour de la médiane, qui se situe dans la partie supérieure de la distribution. Cela suggère que les salaires à l'étranger sont non seulement variés mais ont également tendance à être plus élevés en moyenne, avec un nombre notable d'individus gagnant des salaires considérablement plus élevés, comme en témoigne la partie supérieure étendue du violon.

En comparaison, le graphique en violon pour la France, coloré en cyan, présente une médiane plus basse, une distribution plus resserrée et une queue supérieure moins étendue, ce qui implique que bien que les salaires soient globalement plus bas en France, ils sont également moins dispersés. La concentration des salaires autour de la médiane est plus marquée, indiquant moins de variation dans les niveaux de rémunération.

L'analyse de ces deux distributions souligne les différences potentielles en matière de rémunération entre travailler en France et à l'étranger. Les opportunités à l'étranger peuvent offrir des rémunérations plus élevées, ce qui pourrait être dû à des facteurs économiques variés, y compris le coût de la vie, la demande de compétences spécialisées, ou les politiques salariales des entreprises internationales. Cependant, il est important de noter que le coût de la vie et les avantages sociaux, qui ne sont pas représentés dans ce graphique, jouent également un rôle crucial dans l'évaluation globale des salaires et de la qualité de vie.

### Distribution des salaires en fonction de la région

```{r distributionRegion}

library(ggplot2)

# Assurez-vous d'abord d'exclure les lignes où Region est NA ou a une valeur non désirée
# Remplacez 'valeur non désirée' par la valeur réelle qui représente le secteur non affilié
raw_data <- raw_data[!is.na(raw_data$Region) & raw_data$Region != 'valeur non désirée', ]

# Continuez avec les étapes précédentes
# Calculate average salary by region
avg_salary_by_region <- tapply(raw_data$Salaire_annuel, raw_data$Region, mean)

# Define a color palette for each region
color_palette <- rainbow(length(unique(raw_data$Region)))

# Plotting the distribution of salaries based on region as a pie chart
ggplot(raw_data, aes(x = "", y = Salaire_annuel, fill = Region)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y") +
  theme_void() +  # Removes unnecessary elements
  labs(title = "Répartition des salaires par région",
       fill = "Région",
       y = "Salaire Annuel") +
  scale_fill_manual(values = color_palette)  # Use the color palette without conditionally assigning red




```

Le diagramme en camembert "Répartition des salaires par région" met en évidence les différences dans les salaires moyens à travers diverses régions de France, avec une attention particulière portée à l'Occitanie, l'Île-de-France, l'Auvergne-Rhône-Alpes, la Bretagne et les Pays de la Loire.

L'Occitanie se distingue avec le segment le plus large, indiquant que cette région a la moyenne des salaires la plus élevée parmi celles représentées. Cela pourrait suggérer une présence de secteurs d'activité bien rémunérés ou une concentration de professions spécialisées qui valorisent les compétences de la main-d'œuvre locale.

L'Île-de-France, généralement considérée comme un centre économique majeur en raison de la présence de Paris, est représentée par le deuxième plus grand segment. Malgré son statut de capitale économique, elle ne dépasse pas l'Occitanie dans ce graphique, ce qui pourrait être dû à une gamme plus étendue de salaires dans la région.

L'Auvergne-Rhône-Alpes suit de près, avec un autre segment important. Cette région, connue pour sa diversité économique, incluant l'industrie et le tourisme, montre des salaires moyens élevés, ce qui est cohérent avec son dynamisme économique et industriel.

En contraste, la Bretagne et les Pays de la Loire sont représentés par des segments plus petits, ce qui indique des moyennes de salaires inférieures dans ces régions. Cela pourrait refléter une économie moins orientée vers les industries à haute valeur ajoutée ou un tissu économique axé sur des secteurs offrant des salaires moins élevés.

Dans l'ensemble, cette visualisation offre une perspective utile sur la distribution géographique des salaires en France, montrant que certaines régions, comme l'Occitanie, surpassent d'autres régions plus traditionnellement associées à la richesse économique, telles que l'Île-de-France. Elle met également en lumière les régions qui peuvent être considérées comme moins prospères du point de vue salarial, comme la Bretagne et les Pays de la Loire, et qui pourraient bénéficier de stratégies de développement économique pour améliorer la rémunération des travailleurs.

